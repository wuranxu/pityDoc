---
nav:
title: 部署文档
order: 1
---

# 介绍

  pity基于`Python`+`React`, 如果对于前端不熟悉的同学，可以沿用pity打包好的后端服务，但我建议你这么做。接着我会教大家如何部署一个完整的pity项目。

  首先我们要做的就是拉取代码:

```shell
$ git clone https://github.com/wuranxu/pity # 克隆pity windows需要安装git
$ cd pity  # 进入pity文件夹
```

### 1. 安装MySQL并启动

  如果mysql已经安装过，那么请记住mysql的用户名、密码、ip和端口号。并把mysql启动起来~
  
  - 创建pity库

    由于sqlalchemy只会自动建表，所以`数据库`需要我们执行建立，方法很简单，我们打开数据库控制台(可以navicat/datagrip/mysql -uroot -p)

```shell
CREATE DATABASE IF NOT EXISTS pity default character set utf8mb4 collate utf8mb4_unicode_ci;
```

  这个命令是指，当`pity`数据库不存在时，建立utf8mb4编码的数据库。

### 2. 安装Redis并启动

  参考文档: [安装redis](https://www.runoob.com/redis/redis-install.html)

  需注意，如果此时需要修改redis密码，你可以`百度`如何修改redis配置，一般是改个配置文件即可，这里不细说了。

### 3. 😏 配置环境变量(生产用，可选)

  服务默认的环境变量是dev环境，如果需要部署到生产，请配置环境变量`pity_env=pro`，参考文章: [多环境配置](https://juejin.cn/post/7064035289483706375)

### 4. 安装依赖(需要先安装python)

```shell
# 可换豆瓣源或者清华源安装依赖
$ pip install -r requirements.txt
```

### 5. 修改config.py配置

  记得刚才我跟你说过的MySQL配置数据吗，修改config.py这2处，将MySQL和Redis的信息修改为你自己的。

```python
    # MySQL连接信息
    MYSQL_HOST = ""
    MYSQL_PORT = 
    MYSQL_USER = ""
    MYSQL_PWD = ""
    DBNAME = ""

    REDIS_HOST = ""
    REDIS_PORT = 7788
    REDIS_DB = 0
    REDIS_PASSWORD = ""
```

### 6. 启动服务

```shell
python main.py
```

  在pity目录输入上述命令，即可启动`服务`，开启pity之旅。

  **打开浏览器，输入localhost:7777并回车，开始你的表演！**

### 7. 部署前端（可选）

  注意，部署前端需要先下载安装`nodejs`，自行百度下载，建议下载v14以后的版本。

- 克隆代码

```shell
$ git clone https://github.com/wuranxu/pityWeb
$ cd pityWeb  # 进入pity文件夹
```

- 安装cnpm

```shell
# 安装好nodejs之后，会自动包含npm指令
$ npm install -g cnpm --registry=https://registry.npm.taobao.org
```

- 安装依赖

```shell
# 如果非windows环境，记得加sudo
$ cnpm install
```

- 启动前端服务

```shell
$ npm run start
```

  `只需要`好几分钟，即可打包完毕。接着只需要在浏览器打开: `http://127.0.0.1:8000`即可访问pity了！

