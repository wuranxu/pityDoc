---
nav:
title: 全局变量
order: 6
---

# 全局变量

全局变量的概念，其实也可以`认为`它是一些固定的值，比如我们有一个特定的测试账号（手机号），但是我们以后可能会变化，为了防止以后需要大批量去修改case，所以我们可以将之抽出，变为`全局变量`。

![](http://oss.pity.fun/picture/2022-2-27/1645943070336-image.png)

常用的全局变量场景:

- 城市区号如上海区号->021
- 特定测试手机号
- 特定的数据如http状态码等

  详情请见菜单`管理中心`->`全局变量`页。

### 全局变量类型

在pity里面全局变量一共有3种类型: `字符串`, `YAML`, `JSON`：

![](http://oss.pity.fun/picture/2022-2-27/1645942864429-image.png)

**那么pity不能用数字当全局变量了吗？其实是可以的，我们选择JSON格式，value内容填写对应的数字即可了，我们以圆周率来做一下测试。**

![](http://oss.pity.fun/picture/2022-2-27/1645943029787-image.png)

提交后，我们就得到了`pi`这个全局变量，对应的环境我们选择的是`通用`。

**全局变量也分环境，变量取值的时候优先根据`当前环境`获取值，如果当前环境没有，则会去通用环境寻找。**

这样做的目的是为了保持住一些跨环境的数据，比如圆周率这种，不管你是什么环境，他都是`固定的`数值。

### 全局变量的使用

在pity里面，所有变量的使用规则都是: `${变量名}`, 所以我们要想在case的http请求里面使用，就需要用${}包裹住变量。

接着我们来演示一个demo:

![](http://oss.pity.fun/picture/2022-2-27/1645943413437-image.png)

还是之前的例子，这次`我们在url`里面加入了pi参数，未替换全局变量之前的url应该是：

未替换: https://api.github.com/repos/wuranxu/pity?pi=${pi}
预期替换: https://api.github.com/repos/wuranxu/pity?pi=3.14

我们执行下case，看看实际效果:

![](http://oss.pity.fun/picture/2022-2-27/1645943657661-5.gif)

注意看，实际的请求地址已经被替换成功，日志里面也有`正确的显示`。

### JSON/YAML全局变量使用

对于JSON和YAML类型的全局变量，我们也来看一个简单的例子:

```json
{
  "name": "miluo",
  "age": 29
}
```

当我们的url参数需要传递name和age的时候，我们怎么使用呢？

- 新建全局变量

![](http://oss.pity.fun/picture/2022-2-27/1645943887255-image.png)

- 回到刚才的case，进行一些改动（记得要点`保存`按钮）

  我们只需要用${变量名.字段名}去获取数据即可，如果是数组，则用${变量名.数字索引}。

![](http://oss.pity.fun/picture/2022-2-27/1645943957622-image.png)

这次我们把数据放到header里面:

![](http://oss.pity.fun/picture/2022-2-27/1645944075816-6.gif)

可以看到，header里面也`正确`加入了对应的json数据。

yaml数据也如此，这里就不多介绍了。
  

  
